# Cross-manifest and component-based validation rule specification 
# `attribute` = attribute rule applies to
# `manifest` = the designated component manifest that the rule is used for
# not to be confused with the target manifest or target attribute, 
# which is in the format TargetManifest.TargetAttribute in the rule text
# `level` = whether to raise a warning or an error
# `rules` = list of validation rules to be combined per component

### NOTE: 'required' must go last

---
attributes: 

  - attribute: individualID

    rules_applied_to_manifests:

      - manifest: IndividualHumanMetadataTemplate

        rules: 
          - matchExactlyOne IndividualKey.IndividualID set error
          - unique error
          - required

      - manifest: IndividualAnimalMetadataTemplate
        
        rules: 
          - matchExactlyOne IndividualKey.IndividualID value error
          - unique error
          - required

      - manifest: IndividualAnimalMODEL-ADMetadataTemplate
        
        rules: 
          - matchExactlyOne IndividualKey.IndividualID value error
          - unique error
          - required

      - manifest: FileAnnotationTemplate
        
        rules: 
          - matchExactlyOne IndividualKey.IndividualID value error

      - manifest: BiospecimenMetadataTemplate
        
        rules:
          - matchExactlyOne IndividualKey.IndividualID value error
          - required

      - manifest: BiospecimenInvitroMetadataTemplate
        
        rules:
          - matchExactlyOne IndividualKey.IndividualID value error
          - required

      - manifest: AssayMRIMetadataTemplate
        
        rules:
          - matchExactlyOne IndividualKey.IndividualID value error
          - required

      - manifest: AssayPETMetadataTemplate
        
        rules:
          - matchExactlyOne IndividualKey.IndividualID value error
          - required

      - manifest: AssayAutoradMetadataTemplate
        
        rules: 
          - matchExactlyOne IndividualKey.IndividualID value error
          - required

      - manifest: IndividualKey
        
        rules:
          - matchNone IndividualKey.IndividualID
          - unique error
          - regex match ^[a-zA-Z0-9_-]+$ error
          - required
          

  - attribute: specimenID

    rules_applied_to_manifests:

      - manifest: BiospecimenMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - unique error
          - required

      - manifest: BiospecimenInvitroMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - unique error 
          - required

      - manifest: FileAnnotationTemplate
        
        rules:
          - matchExactlyOne SpecimenKey.SpecimenID value error
      
      - manifest: Assay16SrRNAseqMetadataTemplate
        
        rules:
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required
      
      - manifest: AssayATACSeqMetadataTemplate
        
        rules: 
        - matchExactlyOne SpecimenKey.SpecimenID value error
        - required
      
      - manifest: AssayBisulfiteSeqMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required
      
      - manifest: AssayChIPSeqMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required
      
      - manifest: AssayHICMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required

      - manifest: AssayMetabolomicsMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required

      - manifest: AssayMethylationArrayMetadataTemplate
        
        rules:
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required
      
      - manifest: AssayNanostringMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required

      - manifest: AssayRnaArrayMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required

      - manifest: AssayRnaSeqMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required

      - manifest: AssayScrnaSeqMetadataTemplate
        
        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required

      - manifest: AssayTMTquantitationMetadataTemplate
        
        rules:
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required
      
      - manifest: AssayWholeGenomeSeqMetadataTemplate

        rules: 
          - matchExactlyOne SpecimenKey.SpecimenID value error
          - required

      - manifest: SpecimenKey
        
        rules: 
          - matchNone SpecimenKey.SpecimenID error
          - unique error
          #- regex match ^[a-zA-Z0-9_.-]+ error
          - required
